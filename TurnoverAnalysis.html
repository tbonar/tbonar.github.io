<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Taylor Bonar" />


<title>DDSAnalytics’ Turnover Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Breweries_Case_Study.html">Case Study 1: Craft Beers in the US</a>
</li>
<li>
  <a href="TurnoverAnalysis.html">Case Study 2: Employee Attrition Turnover</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">DDSAnalytics’ Turnover Analysis</h1>
<h4 class="author">Taylor Bonar</h4>
<h4 class="date">4/4/2021</h4>

</div>


<div id="what-causes-employees-to-leave-a-company" class="section level1">
<h1>What causes employees to leave a company?</h1>
<p>Many Fortune 100 companies look to retain talented, high-performing employees when searching for potential workers, but what factors into employees actually leaving volunatry? Could it be job involvement? Pay rates? Years since last promotions? Or something else entirely?</p>
<p>Have no fear, DDSAnalytics aims to identify three factors from 35 variables that leads to employee attrition. With these identified variables, Frito-Lay can properly plan to reduce and prevent attrition and retain highly values employees longer.</p>
<div id="goals-of-study" class="section level2">
<h2>Goals of Study</h2>
<p>The main goal of this study is to explore what potential factors, or rather variables, have the largest impact on employee retention. Once those variables are identified, we will use them to create prediction classification models that identify key predictors that lead to employee turnover rates.</p>
<p>With this information, we can develop mitigation plans in our hiring and retention practices to reduce the likelyhood of losing high-potential employees who meet these targeted areas.</p>
</div>
</div>
<div id="exploratory-data-analysis-exploring-the-initial-data" class="section level1">
<h1>Exploratory Data Analysis: Exploring the Initial Data</h1>
<p>First, we must take a closer look at the variables within our training dataset that we have. We may need to mutate or transform some of these variables in order to find patterns for various levels.</p>
<div id="step-0-what-is-our-dataset-and-do-we-need-to-tidyclean-anything-immediately" class="section level3">
<h3>Step 0: What is our dataset? And do we need to tidy/clean anything immediately?</h3>
<pre class="r"><code>inspect_types(trainingSet) </code></pre>
<pre><code>## # A tibble: 2 x 4
##   type        cnt  pcnt col_name    
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;named list&gt;
## 1 integer      27    75 &lt;chr [27]&gt;  
## 2 character     9    25 &lt;chr [9]&gt;</code></pre>
<pre class="r"><code># Looks like a lot of character classes that could be factors
# Transforming chr variables to factors for use
trainingSet[sapply(trainingSet, is.character)] &lt;- lapply(trainingSet[sapply(trainingSet, is.character)], as.factor)
testAttritionSet[sapply(testAttritionSet, is.character)] &lt;- lapply(testAttritionSet[sapply(testAttritionSet, is.character)], as.factor)
testSalarySet[sapply(testSalarySet, is.character)] &lt;- lapply(testSalarySet[sapply(testSalarySet, is.character)], as.factor)

# Do we have any missing values?
inspect_na(trainingSet) # Nope</code></pre>
<pre><code>## # A tibble: 36 x 3
##    col_name           cnt  pcnt
##    &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt;
##  1 ID                   0     0
##  2 Age                  0     0
##  3 Attrition            0     0
##  4 BusinessTravel       0     0
##  5 DailyRate            0     0
##  6 Department           0     0
##  7 DistanceFromHome     0     0
##  8 Education            0     0
##  9 EducationField       0     0
## 10 EmployeeCount        0     0
## # ... with 26 more rows</code></pre>
<pre class="r"><code>inspect_na(testAttritionSet) # Same, no NAs</code></pre>
<pre><code>## # A tibble: 35 x 3
##    col_name           cnt  pcnt
##    &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt;
##  1 ID                   0     0
##  2 Age                  0     0
##  3 BusinessTravel       0     0
##  4 DailyRate            0     0
##  5 Department           0     0
##  6 DistanceFromHome     0     0
##  7 Education            0     0
##  8 EducationField       0     0
##  9 EmployeeCount        0     0
## 10 EmployeeNumber       0     0
## # ... with 25 more rows</code></pre>
<pre class="r"><code>inspect_na(testSalarySet) # Phew, none anywhere</code></pre>
<pre><code>## # A tibble: 35 x 3
##    col_name           cnt  pcnt
##    &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt;
##  1 ID                   0     0
##  2 Age                  0     0
##  3 Attrition            0     0
##  4 BusinessTravel       0     0
##  5 DailyRate            0     0
##  6 Department           0     0
##  7 DistanceFromHome     0     0
##  8 Education            0     0
##  9 EducationField       0     0
## 10 EmployeeCount        0     0
## # ... with 25 more rows</code></pre>
<pre class="r"><code>trainingSet$Over18 = NULL
testAttritionSet$Over18 = NULL
testSalarySet$Over18 = NULL</code></pre>
</div>
<div id="step-1-data-exploration-what-patterns-are-in-the-data" class="section level3">
<h3>Step 1: Data Exploration – What patterns are in the data?</h3>
<pre class="r"><code>summary(trainingSet)</code></pre>
<pre><code>##        ID             Age        Attrition           BusinessTravel   DailyRate                       Department  DistanceFromHome
##  Min.   :  1.0   Min.   :18.00   No :730   Non-Travel       : 94    Min.   : 103.0   Human Resources       : 35   Min.   : 1.000  
##  1st Qu.:218.2   1st Qu.:30.00   Yes:140   Travel_Frequently:158    1st Qu.: 472.5   Research &amp; Development:562   1st Qu.: 2.000  
##  Median :435.5   Median :35.00             Travel_Rarely    :618    Median : 817.5   Sales                 :273   Median : 7.000  
##  Mean   :435.5   Mean   :36.83                                      Mean   : 815.2                                Mean   : 9.339  
##  3rd Qu.:652.8   3rd Qu.:43.00                                      3rd Qu.:1165.8                                3rd Qu.:14.000  
##  Max.   :870.0   Max.   :60.00                                      Max.   :1499.0                                Max.   :29.000  
##                                                                                                                                   
##    Education              EducationField EmployeeCount EmployeeNumber   EnvironmentSatisfaction    Gender      HourlyRate    
##  Min.   :1.000   Human Resources : 15    Min.   :1     Min.   :   1.0   Min.   :1.000           Female:354   Min.   : 30.00  
##  1st Qu.:2.000   Life Sciences   :358    1st Qu.:1     1st Qu.: 477.2   1st Qu.:2.000           Male  :516   1st Qu.: 48.00  
##  Median :3.000   Marketing       :100    Median :1     Median :1039.0   Median :3.000                        Median : 66.00  
##  Mean   :2.901   Medical         :270    Mean   :1     Mean   :1029.8   Mean   :2.701                        Mean   : 65.61  
##  3rd Qu.:4.000   Other           : 52    3rd Qu.:1     3rd Qu.:1561.5   3rd Qu.:4.000                        3rd Qu.: 83.00  
##  Max.   :5.000   Technical Degree: 75    Max.   :1     Max.   :2064.0   Max.   :4.000                        Max.   :100.00  
##                                                                                                                              
##  JobInvolvement     JobLevel                          JobRole    JobSatisfaction  MaritalStatus MonthlyIncome    MonthlyRate   
##  Min.   :1.000   Min.   :1.000   Sales Executive          :200   Min.   :1.000   Divorced:191   Min.   : 1081   Min.   : 2094  
##  1st Qu.:2.000   1st Qu.:1.000   Research Scientist       :172   1st Qu.:2.000   Married :410   1st Qu.: 2840   1st Qu.: 8092  
##  Median :3.000   Median :2.000   Laboratory Technician    :153   Median :3.000   Single  :269   Median : 4946   Median :14074  
##  Mean   :2.723   Mean   :2.039   Manufacturing Director   : 87   Mean   :2.709                  Mean   : 6390   Mean   :14326  
##  3rd Qu.:3.000   3rd Qu.:3.000   Healthcare Representative: 76   3rd Qu.:4.000                  3rd Qu.: 8182   3rd Qu.:20456  
##  Max.   :4.000   Max.   :5.000   Sales Representative     : 53   Max.   :4.000                  Max.   :19999   Max.   :26997  
##                                  (Other)                  :129                                                                 
##  NumCompaniesWorked OverTime  PercentSalaryHike PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
##  Min.   :0.000      No :618   Min.   :11.0      Min.   :3.000     Min.   :1.000            Min.   :80    Min.   :0.0000  
##  1st Qu.:1.000      Yes:252   1st Qu.:12.0      1st Qu.:3.000     1st Qu.:2.000            1st Qu.:80    1st Qu.:0.0000  
##  Median :2.000                Median :14.0      Median :3.000     Median :3.000            Median :80    Median :1.0000  
##  Mean   :2.728                Mean   :15.2      Mean   :3.152     Mean   :2.707            Mean   :80    Mean   :0.7839  
##  3rd Qu.:4.000                3rd Qu.:18.0      3rd Qu.:3.000     3rd Qu.:4.000            3rd Qu.:80    3rd Qu.:1.0000  
##  Max.   :9.000                Max.   :25.0      Max.   :4.000     Max.   :4.000            Max.   :80    Max.   :3.0000  
##                                                                                                                          
##  TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany   YearsInCurrentRole YearsSinceLastPromotion
##  Min.   : 0.00     Min.   :0.000         Min.   :1.000   Min.   : 0.000   Min.   : 0.000     Min.   : 0.000         
##  1st Qu.: 6.00     1st Qu.:2.000         1st Qu.:2.000   1st Qu.: 3.000   1st Qu.: 2.000     1st Qu.: 0.000         
##  Median :10.00     Median :3.000         Median :3.000   Median : 5.000   Median : 3.000     Median : 1.000         
##  Mean   :11.05     Mean   :2.832         Mean   :2.782   Mean   : 6.962   Mean   : 4.205     Mean   : 2.169         
##  3rd Qu.:15.00     3rd Qu.:3.000         3rd Qu.:3.000   3rd Qu.:10.000   3rd Qu.: 7.000     3rd Qu.: 3.000         
##  Max.   :40.00     Max.   :6.000         Max.   :4.000   Max.   :40.000   Max.   :18.000     Max.   :15.000         
##                                                                                                                     
##  YearsWithCurrManager
##  Min.   : 0.00       
##  1st Qu.: 2.00       
##  Median : 3.00       
##  Mean   : 4.14       
##  3rd Qu.: 7.00       
##  Max.   :17.00       
## </code></pre>
<pre class="r"><code># Describe linear strength of variables using Pearson&#39;s r
linear_corr &lt;- filter(inspect_cor(trainingSet), !is.na(corr))</code></pre>
<pre><code>## Warning: Columns with 0 variance found: EmployeeCount, JobInvolvement, PerformanceRating, StandardHours</code></pre>
<pre class="r"><code>head(linear_corr,10)</code></pre>
<pre><code>## # A tibble: 10 x 7
##    col_1                   col_2               corr   p_value lower upper pcnt_nna
##    &lt;chr&gt;                   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 MonthlyIncome           JobLevel           0.952 9.04e-173 0.945 0.958      100
##  2 TotalWorkingYears       JobLevel           0.781 5.99e-117 0.753 0.805      100
##  3 TotalWorkingYears       MonthlyIncome      0.779 2.73e-116 0.751 0.803      100
##  4 YearsInCurrentRole      YearsAtCompany     0.776 1.38e-115 0.748 0.801      100
##  5 PerformanceRating       PercentSalaryHike  0.775 2.82e-115 0.747 0.800      100
##  6 YearsWithCurrManager    YearsAtCompany     0.765 2.02e-112 0.736 0.791      100
##  7 YearsWithCurrManager    YearsInCurrentRole 0.709 6.60e- 97 0.675 0.741      100
##  8 TotalWorkingYears       Age                0.653 2.71e- 82 0.613 0.689      100
##  9 YearsSinceLastPromotion YearsAtCompany     0.644 3.42e- 80 0.603 0.681      100
## 10 YearsAtCompany          TotalWorkingYears  0.636 2.85e- 78 0.595 0.674      100</code></pre>
<pre class="r"><code># Monthly Income, TotalWorkingYears, JobLevel, YearsInCurrentRole, YearsAtCompany, PerformanceRating, PercenSalaryHike, YearsWithCurrManager, and Age have strong linear correlation, which should affect models
# Plot the data for quantitative variables and look for patterns in regards to qualitative variables
ggplot(trainingSet, aes(x=TotalWorkingYears,y=MonthlyIncome, color=Attrition)) + geom_point() + geom_smooth(method = &quot;lm&quot;,formula = y~x)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-1.png" width="672" /></p>
<pre class="r"><code># Can see there&#39;s a sweet spot between No and Yes to Attrition about 6-7 years for those who make under 4,000/month and additionally, that employee turnover rate is higher than no attrition. Could this be a potential issue for those who make more starting out and see a lower increase in promotions/raises?
# Lastly, we can observe that attrition generally does not occur as frequently as total working years and monthly income increases.
ggplot(trainingSet, aes(x=YearsSinceLastPromotion, fill=Attrition)) + geom_histogram() #+ geom_density(alpha=.2, fill=&quot;blue&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-2.png" width="672" /></p>
<pre class="r"><code># Appears to be a pattern but generally weak, but more higher rates of attrition for those with 2.5 years or less of promotion

# Exploring linear correlated fields
# Top 3 Correlated Variables Sets
ggplot(trainingSet, aes(x=JobLevel,y=MonthlyIncome)) + geom_bar(stat=&quot;identity&quot;, aes(fill=Attrition)) + ggtitle(&quot;Job Level vs. Monthly Income&quot;, subtitle = &quot;Attrition Overview&quot; )</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-3.png" width="672" /></p>
<pre class="r"><code>ggplot(trainingSet, aes(x=TotalWorkingYears)) + geom_bar(aes(fill=Attrition)) + ggtitle(&quot;Attrition vs. Total Working Year&quot;, subtitle = &quot;Attrition Overview&quot; )</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-4.png" width="672" /></p>
<pre class="r"><code># Two spikes, one after about 2 years and one at 10 years with a close 6 years

ggplot(trainingSet, aes(x=JobLevel)) + geom_bar(aes(fill=Attrition)) + ggtitle(&quot;Job Level vs. Monthly Income&quot;, subtitle = &quot;Attrition Overview&quot; )</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-5.png" width="672" /></p>
<pre class="r"><code># Entry level position seem more likely to leave, than those at senior level

# Exploring other fields
ggplot(data=trainingSet, aes(YearsInCurrentRole)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Years in Current Role&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-6.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(YearsAtCompany)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Years at Company&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-7.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(WorkLifeBalance)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Work Life Balance&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-8.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(NumCompaniesWorked)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Number of Companies Worked&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-9.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(Education)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Education&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-10.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(JobSatisfaction)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Job Satisfaction&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-11.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(JobLevel)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Job Level&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-12.png" width="672" /></p>
<pre class="r"><code>ggplot(data=trainingSet, aes(JobRole)) +
  geom_bar(aes(fill=Attrition), position=&quot;fill&quot;) +
  ggtitle(&#39;Percentage of Attrition based on Job Role&#39;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/Patterns-13.png" width="672" /></p>
<p>What top three explanatory variables might be able to explain the relationship to our response variable, attrition?</p>
</div>
<div id="k-nn-modeling" class="section level3">
<h3>k-NN Modeling</h3>
<pre class="r"><code>iterations = 250
numK = 50
masterAcc = matrix(nrow = iterations, ncol = numK)
masterSen = matrix(nrow=iterations,ncol=numK)
masterSpec = matrix(nrow=iterations,ncol=numK)
splitPerc = .7

explanatory_vars1 =c(&quot;MonthlyIncome&quot;,&quot;JobLevel&quot;,&quot;TotalWorkingYears&quot;,&quot;YearsInCurrentRole&quot;,&quot;YearsAtCompany&quot;,&quot;YearsWithCurrManager&quot;)

for(j in 1:iterations) {
  accs = data.frame(accuracy = numeric(30), k = numeric(30))
  trainIndices = sample(1:dim(trainingSet)[1],round(splitPerc * dim(trainingSet)[1]))
  train = trainingSet[trainIndices,]
  test = trainingSet[-trainIndices,]
  for(i in 1:numK) {
    knnClassifications = knn(train[,explanatory_vars1], test[,explanatory_vars1], train$Attrition, k=i, prob = T)
    CM = confusionMatrix(table(knnClassifications,test$Attrition))
    
    masterAcc[j,i] = CM$overall[1]
    masterSen[j,i] = CM$byClass[1]
    masterSpec[j,i] = CM$byClass[2]
  }
}

# Graph k-values mean accuracies to observe best k-value to use
MeanAcc = colMeans(masterAcc)
plot(seq(1,numK,1),MeanAcc, type = &quot;l&quot;,
     main=&quot;Average Accuracy of k-values&quot;,
     xlab = &quot;k-values&quot;,
     ylab = &quot;Average Accuracy&quot;)</code></pre>
<p><img src="TurnoverAnalysis_files/figure-html/k-NN%20Model-1.png" width="672" /></p>
<pre class="r"><code># Grab most accurate k-value (i.e. the one with the highest average accuracy)
strongK = which.max(MeanAcc)

# Use KNN to classify attrition
classifications = knn(trainingSet[,explanatory_vars1], testAttritionSet[,explanatory_vars1], trainingSet$Attrition, k = strongK, prob=T)

knnSubmission = tibble(&quot;ID&quot;=testAttritionSet$ID, &quot;Attrition&quot;= classifications)
write.csv(knnSubmission,&quot;Case2PredictionsTbonar Attrition.csv&quot;,row.names = FALSE)</code></pre>
</div>
<div id="naive-bayes-modeling" class="section level3">
<h3>Naive Bayes Modeling</h3>
<pre class="r"><code># Creating a 70/30 split for training
iterations = 500
masterAcc = matrix(nrow=iterations)
masterSen = matrix(nrow=iterations)
masterSpec = matrix(nrow=iterations)
splitPerc = .7

explanatory_vars2 =c(&quot;MonthlyIncome&quot;,&quot;JobLevel&quot;,&quot;TotalWorkingYears&quot;,&quot;YearsInCurrentRole&quot;,&quot;YearsAtCompany&quot;,&quot;YearsWithCurrManager&quot;)

masterAcc2 = matrix(nrow=iterations)
masterSen2 = matrix(nrow=iterations)
masterSpec2 = matrix(nrow=iterations)
for(j in 1:iterations) {
  trainIndices = sample(1:dim(trainingSet)[1],round(splitPerc * dim(trainingSet)[1]))
  train = trainingSet[trainIndices,]
  test = trainingSet[-trainIndices,]
  nbModel = naiveBayes(train[,explanatory_vars2], train$Attrition)
  CM2 = confusionMatrix(table(predict(nbModel,test[,explanatory_vars2]),test$Attrition))

  masterSen2[j] = CM2$byClass[1]
  masterSpec2[j] = CM2$byClass[2]
}

MeanSen2 = colMeans(masterSen2)
MeanSpec2 = colMeans(masterSpec2)

MeanSen2</code></pre>
<pre><code>## [1] 0.8017233</code></pre>
<pre class="r"><code>MeanSpec2</code></pre>
<pre><code>## [1] 0.4571041</code></pre>
<pre class="r"><code># Sensitivity = 0.652669
# Specificity = 0.6091083

# Repeat for true test set
predictedAttributes = predict(nbModel, newdata = testAttritionSet)
nbSubmission = tibble(&quot;ID&quot;= testAttritionSet$ID, &quot;Attrition&quot; = predictedAttributes)
write.csv(nbSubmission,&quot;Case2PredictionsTbonar Attrition.csv&quot;,row.names = FALSE)</code></pre>
</div>
<div id="compare-and-contrasting-competing-models" class="section level3">
<h3>Compare and Contrasting Competing Models</h3>
<p>Naive Bayes model has a higher specificity and sensitivity, therefore it is the more accurate model when comparing the k-NN. ## Salary Predictions</p>
<pre class="r"><code>library(olsrr)
# HTML CSS - Libraries for Coefficient Table (e.g. tab_model())
library(sjPlot)
library(sjmisc)
library(sjlabelled)
fit1 = lm(MonthlyIncome ~ . , data=trainingSet)
# Option 1 for auto-generating summary statistics -- PDF doesn&#39;t like, good for HTML quick referencing
summary(fit1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ ., data = trainingSet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3708.8  -674.1    14.7   614.1  4100.0 
## 
## Coefficients: (2 not defined because of singularities)
##                                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                       6.013e+01  7.772e+02   0.077 0.938349    
## ID                               -2.343e-01  1.476e-01  -1.588 0.112713    
## Age                              -1.431e+00  5.649e+00  -0.253 0.800110    
## AttritionYes                      8.904e+01  1.154e+02   0.771 0.440729    
## BusinessTravelTravel_Frequently   1.895e+02  1.420e+02   1.334 0.182441    
## BusinessTravelTravel_Rarely       3.720e+02  1.200e+02   3.099 0.002005 ** 
## DailyRate                         1.452e-01  9.129e-02   1.591 0.112062    
## DepartmentResearch &amp; Development  1.234e+02  4.768e+02   0.259 0.795866    
## DepartmentSales                  -4.594e+02  4.877e+02  -0.942 0.346580    
## DistanceFromHome                 -6.237e+00  4.578e+00  -1.362 0.173417    
## Education                        -3.743e+01  3.716e+01  -1.007 0.314105    
## EducationFieldLife Sciences       1.352e+02  3.692e+02   0.366 0.714248    
## EducationFieldMarketing           1.377e+02  3.914e+02   0.352 0.725050    
## EducationFieldMedical             3.326e+01  3.699e+02   0.090 0.928376    
## EducationFieldOther               9.152e+01  3.946e+02   0.232 0.816664    
## EducationFieldTechnical Degree    9.680e+01  3.843e+02   0.252 0.801179    
## EmployeeCount                            NA         NA      NA       NA    
## EmployeeNumber                    8.681e-02  6.103e-02   1.422 0.155269    
## EnvironmentSatisfaction          -6.267e+00  3.364e+01  -0.186 0.852252    
## GenderMale                        1.100e+02  7.442e+01   1.478 0.139715    
## HourlyRate                       -3.591e-01  1.824e+00  -0.197 0.844003    
## JobInvolvement                    1.677e+01  5.321e+01   0.315 0.752698    
## JobLevel                          2.783e+03  8.340e+01  33.375  &lt; 2e-16 ***
## JobRoleHuman Resources           -2.053e+02  5.157e+02  -0.398 0.690663    
## JobRoleLaboratory Technician     -5.891e+02  1.714e+02  -3.437 0.000618 ***
## JobRoleManager                    4.280e+03  2.830e+02  15.122  &lt; 2e-16 ***
## JobRoleManufacturing Director     1.809e+02  1.696e+02   1.067 0.286497    
## JobRoleResearch Director          4.077e+03  2.193e+02  18.592  &lt; 2e-16 ***
## JobRoleResearch Scientist        -3.494e+02  1.705e+02  -2.049 0.040790 *  
## JobRoleSales Executive            5.263e+02  3.576e+02   1.472 0.141449    
## JobRoleSales Representative       8.531e+01  3.918e+02   0.218 0.827703    
## JobSatisfaction                   3.278e+01  3.344e+01   0.980 0.327278    
## MaritalStatusMarried              6.708e+01  1.002e+02   0.669 0.503497    
## MaritalStatusSingle               1.128e+01  1.361e+02   0.083 0.933978    
## MonthlyRate                      -9.505e-03  5.143e-03  -1.848 0.064946 .  
## NumCompaniesWorked                5.421e+00  1.691e+01   0.321 0.748622    
## OverTimeYes                      -1.394e+01  8.434e+01  -0.165 0.868787    
## PercentSalaryHike                 2.586e+01  1.581e+01   1.635 0.102351    
## PerformanceRating                -3.235e+02  1.614e+02  -2.004 0.045368 *  
## RelationshipSatisfaction          1.640e+01  3.339e+01   0.491 0.623375    
## StandardHours                            NA         NA      NA       NA    
## StockOptionLevel                 -2.758e+00  5.740e+01  -0.048 0.961695    
## TotalWorkingYears                 5.080e+01  1.098e+01   4.627  4.3e-06 ***
## TrainingTimesLastYear             2.436e+01  2.912e+01   0.837 0.403111    
## WorkLifeBalance                  -3.472e+01  5.161e+01  -0.673 0.501284    
## YearsAtCompany                   -2.750e+00  1.370e+01  -0.201 0.840925    
## YearsInCurrentRole                3.398e+00  1.711e+01   0.199 0.842584    
## YearsSinceLastPromotion           3.084e+01  1.532e+01   2.013 0.044405 *  
## YearsWithCurrManager             -2.691e+01  1.669e+01  -1.613 0.107210    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1055 on 823 degrees of freedom
## Multiple R-squared:  0.9501, Adjusted R-squared:  0.9473 
## F-statistic: 340.7 on 46 and 823 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>confint(fit1)</code></pre>
<pre><code>##                                          2.5 %        97.5 %
## (Intercept)                      -1.465342e+03  1.585599e+03
## ID                               -5.240296e-01  5.535072e-02
## Age                              -1.251963e+01  9.657839e+00
## AttritionYes                     -1.375461e+02  3.156292e+02
## BusinessTravelTravel_Frequently  -8.926060e+01  4.683197e+02
## BusinessTravelTravel_Rarely       1.364027e+02  6.075135e+02
## DailyRate                        -3.397230e-02  3.243870e-01
## DepartmentResearch &amp; Development -8.124440e+02  1.059204e+03
## DepartmentSales                  -1.416732e+03  4.980248e+02
## DistanceFromHome                 -1.522302e+01  2.748390e+00
## Education                        -1.103679e+02  3.550917e+01
## EducationFieldLife Sciences      -5.894170e+02  8.598636e+02
## EducationFieldMarketing          -6.305139e+02  9.059160e+02
## EducationFieldMedical            -6.927808e+02  7.592991e+02
## EducationFieldOther              -6.830713e+02  8.661080e+02
## EducationFieldTechnical Degree   -6.574880e+02  8.510916e+02
## EmployeeCount                               NA            NA
## EmployeeNumber                   -3.297855e-02  2.066004e-01
## EnvironmentSatisfaction          -7.229713e+01  5.976265e+01
## GenderMale                       -3.605966e+01  2.560754e+02
## HourlyRate                       -3.939945e+00  3.221757e+00
## JobInvolvement                   -8.767298e+01  1.212157e+02
## JobLevel                          2.619720e+03  2.947113e+03
## JobRoleHuman Resources           -1.217537e+03  8.069428e+02
## JobRoleLaboratory Technician     -9.255793e+02 -2.526468e+02
## JobRoleManager                    3.724012e+03  4.834990e+03
## JobRoleManufacturing Director    -1.520453e+02  5.138823e+02
## JobRoleResearch Director          3.646192e+03  4.506949e+03
## JobRoleResearch Scientist        -6.840651e+02 -1.466993e+01
## JobRoleSales Executive           -1.755811e+02  1.228188e+03
## JobRoleSales Representative      -6.838279e+02  8.544530e+02
## JobSatisfaction                  -3.286470e+01  9.842948e+01
## MaritalStatusMarried             -1.296555e+02  2.638238e+02
## MaritalStatusSingle              -2.557990e+02  2.783493e+02
## MonthlyRate                      -1.960084e-02  5.901864e-04
## NumCompaniesWorked               -2.777223e+01  3.861416e+01
## OverTimeYes                      -1.794826e+02  1.516084e+02
## PercentSalaryHike                -5.177361e+00  5.688932e+01
## PerformanceRating                -6.403131e+02 -6.686322e+00
## RelationshipSatisfaction         -4.913524e+01  8.194067e+01
## StandardHours                               NA            NA
## StockOptionLevel                 -1.154261e+02  1.099109e+02
## TotalWorkingYears                 2.925434e+01  7.235470e+01
## TrainingTimesLastYear            -3.280068e+01  8.152145e+01
## WorkLifeBalance                  -1.360279e+02  6.658295e+01
## YearsAtCompany                   -2.963784e+01  2.413735e+01
## YearsInCurrentRole               -3.017664e+01  3.697252e+01
## YearsSinceLastPromotion           7.731945e-01  6.090238e+01
## YearsWithCurrManager             -5.966955e+01  5.844847e+00</code></pre>
<pre class="r"><code>ols_step_both_p(fit1, premo = 0.05, details=T)</code></pre>
<pre><code>## Stepwise Selection Method   
## ---------------------------
## 
## Candidate Terms: 
## 
## 1. ID 
## 2. Age 
## 3. Attrition 
## 4. BusinessTravel 
## 5. DailyRate 
## 6. Department 
## 7. DistanceFromHome 
## 8. Education 
## 9. EducationField 
## 10. EmployeeCount 
## 11. EmployeeNumber 
## 12. EnvironmentSatisfaction 
## 13. Gender 
## 14. HourlyRate 
## 15. JobInvolvement 
## 16. JobLevel 
## 17. JobRole 
## 18. JobSatisfaction 
## 19. MaritalStatus 
## 20. MonthlyRate 
## 21. NumCompaniesWorked 
## 22. OverTime 
## 23. PercentSalaryHike 
## 24. PerformanceRating 
## 25. RelationshipSatisfaction 
## 26. StandardHours 
## 27. StockOptionLevel 
## 28. TotalWorkingYears 
## 29. TrainingTimesLastYear 
## 30. WorkLifeBalance 
## 31. YearsAtCompany 
## 32. YearsInCurrentRole 
## 33. YearsSinceLastPromotion 
## 34. YearsWithCurrManager 
## 
## We are selecting variables based on p value...</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 1 
## 
## + JobLevel 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.952       RMSE                  1413.296 
## R-Squared               0.906       Coef. Var               22.116 
## Adj. R-Squared          0.906       MSE                1997404.971 
## Pred R-Squared          0.905       MAE                   1073.683 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                        
## ----------------------------------------------------------------------------------
##                        Sum of                                                     
##                       Squares         DF        Mean Square       F          Sig. 
## ----------------------------------------------------------------------------------
## Regression    16635876872.790          1    16635876872.790    8328.745    0.0000 
## Residual       1733747514.405        868        1997404.971                       
## Total         18369624387.195        869                                          
## ----------------------------------------------------------------------------------
## 
##                                        Parameter Estimates                                         
## --------------------------------------------------------------------------------------------------
##       model         Beta    Std. Error    Std. Beta       t        Sig         lower        upper 
## --------------------------------------------------------------------------------------------------
## (Intercept)    -1793.934       101.676                 -17.644    0.000    -1993.494    -1594.375 
##    JobLevel     4013.671        43.980        0.952     91.262    0.000     3927.352     4099.990 
## --------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 2 
## 
## + JobRole 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.972       RMSE                  1084.436 
## R-Squared               0.945       Coef. Var               16.970 
## Adj. R-Squared          0.944       MSE                1176000.366 
## Pred R-Squared          0.944       MAE                    826.745 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17358264072.801          9    1928696008.089    1640.047    0.0000 
## Residual       1011360314.394        860       1176000.366                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                               Parameter Estimates                                                
## ----------------------------------------------------------------------------------------------------------------
##                         model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ----------------------------------------------------------------------------------------------------------------
##                   (Intercept)    -159.883       207.216                 -0.772    0.441    -566.592     246.826 
##                      JobLevel    3086.830        67.354        0.732    45.830    0.000    2954.633    3219.026 
##        JobRoleHuman Resources    -328.279       256.877       -0.012    -1.278    0.202    -832.457     175.900 
##  JobRoleLaboratory Technician    -532.280       172.081       -0.044    -3.093    0.002    -870.027    -194.533 
##                JobRoleManager    3980.779       233.332        0.204    17.061    0.000    3522.811    4438.746 
## JobRoleManufacturing Director      72.211       170.267        0.005     0.424    0.672    -261.977     406.399 
##      JobRoleResearch Director    3925.623       218.411        0.201    17.974    0.000    3496.942    4354.305 
##     JobRoleResearch Scientist    -241.909       172.278       -0.021    -1.404    0.161    -580.042      96.225 
##        JobRoleSales Executive    -156.084       146.373       -0.014    -1.066    0.287    -443.375     131.207 
##   JobRoleSales Representative    -448.842       215.879       -0.023    -2.079    0.038    -872.554     -25.130 
## ----------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.972       RMSE                  1084.436 
## R-Squared               0.945       Coef. Var               16.970 
## Adj. R-Squared          0.944       MSE                1176000.366 
## Pred R-Squared          0.944       MAE                    826.745 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17358264072.801          9    1928696008.089    1640.047    0.0000 
## Residual       1011360314.394        860       1176000.366                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                               Parameter Estimates                                                
## ----------------------------------------------------------------------------------------------------------------
##                         model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ----------------------------------------------------------------------------------------------------------------
##                   (Intercept)    -159.883       207.216                 -0.772    0.441    -566.592     246.826 
##                      JobLevel    3086.830        67.354        0.732    45.830    0.000    2954.633    3219.026 
##        JobRoleHuman Resources    -328.279       256.877       -0.012    -1.278    0.202    -832.457     175.900 
##  JobRoleLaboratory Technician    -532.280       172.081       -0.044    -3.093    0.002    -870.027    -194.533 
##                JobRoleManager    3980.779       233.332        0.204    17.061    0.000    3522.811    4438.746 
## JobRoleManufacturing Director      72.211       170.267        0.005     0.424    0.672    -261.977     406.399 
##      JobRoleResearch Director    3925.623       218.411        0.201    17.974    0.000    3496.942    4354.305 
##     JobRoleResearch Scientist    -241.909       172.278       -0.021    -1.404    0.161    -580.042      96.225 
##        JobRoleSales Executive    -156.084       146.373       -0.014    -1.066    0.287    -443.375     131.207 
##   JobRoleSales Representative    -448.842       215.879       -0.023    -2.079    0.038    -872.554     -25.130 
## ----------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 3 
## 
## + TotalWorkingYears 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.973       RMSE                  1062.757 
## R-Squared               0.947       Coef. Var               16.631 
## Adj. R-Squared          0.947       MSE                1129452.420 
## Pred R-Squared          0.946       MAE                    805.151 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17399424758.568         10    1739942475.857    1540.519    0.0000 
## Residual        970199628.628        859       1129452.420                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                               Parameter Estimates                                                
## ----------------------------------------------------------------------------------------------------------------
##                         model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ----------------------------------------------------------------------------------------------------------------
##                   (Intercept)    -103.243       203.291                 -0.508    0.612    -502.248     295.761 
##                      JobLevel    2795.329        81.784        0.663    34.179    0.000    2634.809    2955.848 
##        JobRoleHuman Resources    -321.962       251.744       -0.012    -1.279    0.201    -816.066     172.143 
##  JobRoleLaboratory Technician    -597.329       168.984       -0.049    -3.535    0.000    -928.999    -265.658 
##                JobRoleManager    4002.415       228.696        0.205    17.501    0.000    3553.547    4451.283 
## JobRoleManufacturing Director     137.309       167.212        0.009     0.821    0.412    -190.882     465.500 
##      JobRoleResearch Director    3993.674       214.342        0.204    18.632    0.000    3572.979    4414.368 
##     JobRoleResearch Scientist    -324.522       169.387       -0.028    -1.916    0.056    -656.983       7.940 
##        JobRoleSales Executive     -66.048       144.221       -0.006    -0.458    0.647    -349.114     217.018 
##   JobRoleSales Representative    -410.303       211.660       -0.021    -1.939    0.053    -825.735       5.128 
##             TotalWorkingYears      47.998         7.951        0.078     6.037    0.000      32.393      63.604 
## ----------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.973       RMSE                  1062.757 
## R-Squared               0.947       Coef. Var               16.631 
## Adj. R-Squared          0.947       MSE                1129452.420 
## Pred R-Squared          0.946       MAE                    805.151 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17399424758.568         10    1739942475.857    1540.519    0.0000 
## Residual        970199628.628        859       1129452.420                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                               Parameter Estimates                                                
## ----------------------------------------------------------------------------------------------------------------
##                         model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ----------------------------------------------------------------------------------------------------------------
##                   (Intercept)    -103.243       203.291                 -0.508    0.612    -502.248     295.761 
##                      JobLevel    2795.329        81.784        0.663    34.179    0.000    2634.809    2955.848 
##        JobRoleHuman Resources    -321.962       251.744       -0.012    -1.279    0.201    -816.066     172.143 
##  JobRoleLaboratory Technician    -597.329       168.984       -0.049    -3.535    0.000    -928.999    -265.658 
##                JobRoleManager    4002.415       228.696        0.205    17.501    0.000    3553.547    4451.283 
## JobRoleManufacturing Director     137.309       167.212        0.009     0.821    0.412    -190.882     465.500 
##      JobRoleResearch Director    3993.674       214.342        0.204    18.632    0.000    3572.979    4414.368 
##     JobRoleResearch Scientist    -324.522       169.387       -0.028    -1.916    0.056    -656.983       7.940 
##        JobRoleSales Executive     -66.048       144.221       -0.006    -0.458    0.647    -349.114     217.018 
##   JobRoleSales Representative    -410.303       211.660       -0.021    -1.939    0.053    -825.735       5.128 
##             TotalWorkingYears      47.998         7.951        0.078     6.037    0.000      32.393      63.604 
## ----------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 4 
## 
## + BusinessTravel 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1056.112 
## R-Squared               0.948       Coef. Var               16.527 
## Adj. R-Squared          0.947       MSE                1115372.650 
## Pred R-Squared          0.946       MAE                    797.128 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17413750026.222         12    1451145835.519    1301.041    0.0000 
## Residual        955874360.973        857       1115372.650                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -394.779       221.854                 -1.779    0.076    -830.220      40.661 
##                        JobLevel    2793.859        81.373        0.662    34.334    0.000    2634.144    2953.573 
##          JobRoleHuman Resources    -364.337       250.466       -0.014    -1.455    0.146    -855.936     127.262 
##    JobRoleLaboratory Technician    -613.101       168.199       -0.051    -3.645    0.000    -943.232    -282.970 
##                  JobRoleManager    3981.398       227.872        0.204    17.472    0.000    3534.147    4428.650 
##   JobRoleManufacturing Director     109.924       166.405        0.007     0.661    0.509    -216.686     436.534 
##        JobRoleResearch Director    3974.304       213.358        0.203    18.627    0.000    3555.539    4393.068 
##       JobRoleResearch Scientist    -339.601       168.463       -0.029    -2.016    0.044    -670.250      -8.952 
##          JobRoleSales Executive     -70.682       143.340       -0.006    -0.493    0.622    -352.022     210.657 
##     JobRoleSales Representative    -414.765       211.371       -0.022    -1.962    0.050    -829.631       0.101 
##               TotalWorkingYears      47.657         7.907        0.078     6.027    0.000      32.138      63.177 
## BusinessTravelTravel_Frequently     204.515       138.961        0.017     1.472    0.141     -68.228     477.258 
##     BusinessTravelTravel_Rarely     386.672       117.471        0.038     3.292    0.001     156.107     617.237 
## ------------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1056.112 
## R-Squared               0.948       Coef. Var               16.527 
## Adj. R-Squared          0.947       MSE                1115372.650 
## Pred R-Squared          0.946       MAE                    797.128 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17413750026.222         12    1451145835.519    1301.041    0.0000 
## Residual        955874360.973        857       1115372.650                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -394.779       221.854                 -1.779    0.076    -830.220      40.661 
##                        JobLevel    2793.859        81.373        0.662    34.334    0.000    2634.144    2953.573 
##          JobRoleHuman Resources    -364.337       250.466       -0.014    -1.455    0.146    -855.936     127.262 
##    JobRoleLaboratory Technician    -613.101       168.199       -0.051    -3.645    0.000    -943.232    -282.970 
##                  JobRoleManager    3981.398       227.872        0.204    17.472    0.000    3534.147    4428.650 
##   JobRoleManufacturing Director     109.924       166.405        0.007     0.661    0.509    -216.686     436.534 
##        JobRoleResearch Director    3974.304       213.358        0.203    18.627    0.000    3555.539    4393.068 
##       JobRoleResearch Scientist    -339.601       168.463       -0.029    -2.016    0.044    -670.250      -8.952 
##          JobRoleSales Executive     -70.682       143.340       -0.006    -0.493    0.622    -352.022     210.657 
##     JobRoleSales Representative    -414.765       211.371       -0.022    -1.962    0.050    -829.631       0.101 
##               TotalWorkingYears      47.657         7.907        0.078     6.027    0.000      32.138      63.177 
## BusinessTravelTravel_Frequently     204.515       138.961        0.017     1.472    0.141     -68.228     477.258 
##     BusinessTravelTravel_Rarely     386.672       117.471        0.038     3.292    0.001     156.107     617.237 
## ------------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 5 
## 
## + Gender 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1054.722 
## R-Squared               0.948       Coef. Var               16.505 
## Adj. R-Squared          0.947       MSE                1112439.436 
## Pred R-Squared          0.947       MAE                    797.414 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17417376230.084         13    1339798171.545    1204.379    0.0000 
## Residual        952248157.111        856       1112439.436                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -478.919       226.410                 -2.115    0.035    -923.303     -34.536 
##                        JobLevel    2792.584        81.269        0.662    34.362    0.000    2633.073    2952.094 
##          JobRoleHuman Resources    -374.979       250.206       -0.014    -1.499    0.134    -866.069     116.110 
##    JobRoleLaboratory Technician    -625.023       168.108       -0.052    -3.718    0.000    -954.974    -295.071 
##                  JobRoleManager    3985.659       227.584        0.204    17.513    0.000    3538.971    4432.347 
##   JobRoleManufacturing Director     118.224       166.250        0.008     0.711    0.477    -208.081     444.529 
##        JobRoleResearch Director    3974.664       213.077        0.203    18.654    0.000    3556.450    4392.879 
##       JobRoleResearch Scientist    -345.383       168.272       -0.030    -2.053    0.040    -675.657     -15.109 
##          JobRoleSales Executive     -74.387       143.166       -0.007    -0.520    0.603    -355.385     206.612 
##     JobRoleSales Representative    -405.032       211.162       -0.021    -1.918    0.055    -819.488       9.424 
##               TotalWorkingYears      48.192         7.902        0.079     6.099    0.000      32.682      63.701 
## BusinessTravelTravel_Frequently     214.458       138.887        0.018     1.544    0.123     -58.141     487.057 
##     BusinessTravelTravel_Rarely     391.128       117.343        0.039     3.333    0.001     160.815     621.441 
##                      GenderMale     132.512        73.395        0.014     1.805    0.071     -11.544     276.567 
## ------------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1054.722 
## R-Squared               0.948       Coef. Var               16.505 
## Adj. R-Squared          0.947       MSE                1112439.436 
## Pred R-Squared          0.947       MAE                    797.414 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17417376230.084         13    1339798171.545    1204.379    0.0000 
## Residual        952248157.111        856       1112439.436                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -478.919       226.410                 -2.115    0.035    -923.303     -34.536 
##                        JobLevel    2792.584        81.269        0.662    34.362    0.000    2633.073    2952.094 
##          JobRoleHuman Resources    -374.979       250.206       -0.014    -1.499    0.134    -866.069     116.110 
##    JobRoleLaboratory Technician    -625.023       168.108       -0.052    -3.718    0.000    -954.974    -295.071 
##                  JobRoleManager    3985.659       227.584        0.204    17.513    0.000    3538.971    4432.347 
##   JobRoleManufacturing Director     118.224       166.250        0.008     0.711    0.477    -208.081     444.529 
##        JobRoleResearch Director    3974.664       213.077        0.203    18.654    0.000    3556.450    4392.879 
##       JobRoleResearch Scientist    -345.383       168.272       -0.030    -2.053    0.040    -675.657     -15.109 
##          JobRoleSales Executive     -74.387       143.166       -0.007    -0.520    0.603    -355.385     206.612 
##     JobRoleSales Representative    -405.032       211.162       -0.021    -1.918    0.055    -819.488       9.424 
##               TotalWorkingYears      48.192         7.902        0.079     6.099    0.000      32.682      63.701 
## BusinessTravelTravel_Frequently     214.458       138.887        0.018     1.544    0.123     -58.141     487.057 
##     BusinessTravelTravel_Rarely     391.128       117.343        0.039     3.333    0.001     160.815     621.441 
##                      GenderMale     132.512        73.395        0.014     1.805    0.071     -11.544     276.567 
## ------------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 6 
## 
## + DailyRate 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1053.415 
## R-Squared               0.948       Coef. Var               16.485 
## Adj. R-Squared          0.948       MSE                1109683.008 
## Pred R-Squared          0.947       MAE                    797.109 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17420845415.468         14    1244346101.105    1121.353    0.0000 
## Residual        948778971.727        855       1109683.008                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                 Parameter Estimates                                                 
## -------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
## -------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -613.687       238.629                 -2.572    0.010    -1082.055    -145.318 
##                        JobLevel    2788.082        81.208        0.661    34.332    0.000     2628.691    2947.473 
##          JobRoleHuman Resources    -369.809       249.913       -0.014    -1.480    0.139     -860.323     120.706 
##    JobRoleLaboratory Technician    -618.931       167.935       -0.051    -3.686    0.000     -948.543    -289.318 
##                  JobRoleManager    4018.142       228.043        0.205    17.620    0.000     3570.552    4465.732 
##   JobRoleManufacturing Director     123.687       166.073        0.008     0.745    0.457     -202.270     449.645 
##        JobRoleResearch Director    3991.979       213.038        0.204    18.738    0.000     3573.840    4410.118 
##       JobRoleResearch Scientist    -340.918       168.082       -0.030    -2.028    0.043     -670.821     -11.016 
##          JobRoleSales Executive     -70.310       143.008       -0.006    -0.492    0.623     -350.997     210.377 
##     JobRoleSales Representative    -401.296       210.911       -0.021    -1.903    0.057     -815.260      12.668 
##               TotalWorkingYears      48.256         7.892        0.079     6.114    0.000       32.765      63.746 
## BusinessTravelTravel_Frequently     225.416       138.853        0.019     1.623    0.105      -47.117     497.949 
##     BusinessTravelTravel_Rarely     397.764       117.257        0.039     3.392    0.001      167.618     627.909 
##                      GenderMale     133.714        73.307        0.014     1.824    0.068      -10.169     277.597 
##                       DailyRate       0.158         0.090        0.014     1.768    0.077       -0.017       0.334 
## -------------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1053.415 
## R-Squared               0.948       Coef. Var               16.485 
## Adj. R-Squared          0.948       MSE                1109683.008 
## Pred R-Squared          0.947       MAE                    797.109 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression    17420845415.468         14    1244346101.105    1121.353    0.0000 
## Residual        948778971.727        855       1109683.008                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                 Parameter Estimates                                                 
## -------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
## -------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -613.687       238.629                 -2.572    0.010    -1082.055    -145.318 
##                        JobLevel    2788.082        81.208        0.661    34.332    0.000     2628.691    2947.473 
##          JobRoleHuman Resources    -369.809       249.913       -0.014    -1.480    0.139     -860.323     120.706 
##    JobRoleLaboratory Technician    -618.931       167.935       -0.051    -3.686    0.000     -948.543    -289.318 
##                  JobRoleManager    4018.142       228.043        0.205    17.620    0.000     3570.552    4465.732 
##   JobRoleManufacturing Director     123.687       166.073        0.008     0.745    0.457     -202.270     449.645 
##        JobRoleResearch Director    3991.979       213.038        0.204    18.738    0.000     3573.840    4410.118 
##       JobRoleResearch Scientist    -340.918       168.082       -0.030    -2.028    0.043     -670.821     -11.016 
##          JobRoleSales Executive     -70.310       143.008       -0.006    -0.492    0.623     -350.997     210.377 
##     JobRoleSales Representative    -401.296       210.911       -0.021    -1.903    0.057     -815.260      12.668 
##               TotalWorkingYears      48.256         7.892        0.079     6.114    0.000       32.765      63.746 
## BusinessTravelTravel_Frequently     225.416       138.853        0.019     1.623    0.105      -47.117     497.949 
##     BusinessTravelTravel_Rarely     397.764       117.257        0.039     3.392    0.001      167.618     627.909 
##                      GenderMale     133.714        73.307        0.014     1.824    0.068      -10.169     277.597 
##                       DailyRate       0.158         0.090        0.014     1.768    0.077       -0.017       0.334 
## -------------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## Stepwise Selection: Step 7 
## 
## + MonthlyRate 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1052.279 
## R-Squared               0.949       Coef. Var               16.467 
## Adj. R-Squared          0.948       MSE                1107291.625 
## Pred R-Squared          0.947       MAE                    796.933 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression         1.7424e+10         15    1161599822.648    1049.046    0.0000 
## Residual        945627047.481        854       1107291.625                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -485.205       250.241                 -1.939    0.053    -976.364       5.954 
##                        JobLevel    2789.021        81.123        0.661    34.380    0.000    2629.798    2948.244 
##          JobRoleHuman Resources    -377.636       249.687       -0.014    -1.512    0.131    -867.708     112.435 
##    JobRoleLaboratory Technician    -619.843       167.755       -0.051    -3.695    0.000    -949.102    -290.583 
##                  JobRoleManager    4018.929       227.798        0.205    17.643    0.000    3571.820    4466.037 
##   JobRoleManufacturing Director     127.393       165.908        0.008     0.768    0.443    -198.242     453.029 
##        JobRoleResearch Director    4009.398       213.059        0.205    18.818    0.000    3591.218    4427.578 
##       JobRoleResearch Scientist    -346.550       167.934       -0.030    -2.064    0.039    -676.163     -16.938 
##          JobRoleSales Executive     -72.176       142.858       -0.007    -0.505    0.614    -352.570     208.217 
##     JobRoleSales Representative    -404.178       210.690       -0.021    -1.918    0.055    -817.710       9.354 
##               TotalWorkingYears      48.287         7.884        0.079     6.125    0.000      32.813      63.762 
## BusinessTravelTravel_Frequently     219.052       138.755        0.018     1.579    0.115     -53.289     491.392 
##     BusinessTravelTravel_Rarely     396.178       117.135        0.039     3.382    0.001     166.273     626.083 
##                      GenderMale     130.188        73.258        0.014     1.777    0.076     -13.599     273.975 
##                       DailyRate       0.154         0.089        0.013     1.721    0.086      -0.022       0.330 
##                     MonthlyRate      -0.009         0.005       -0.013    -1.687    0.092      -0.018       0.001 
## ------------------------------------------------------------------------------------------------------------------
## 
## 
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1052.279 
## R-Squared               0.949       Coef. Var               16.467 
## Adj. R-Squared          0.948       MSE                1107291.625 
## Pred R-Squared          0.947       MAE                    796.933 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression         1.7424e+10         15    1161599822.648    1049.046    0.0000 
## Residual        945627047.481        854       1107291.625                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -485.205       250.241                 -1.939    0.053    -976.364       5.954 
##                        JobLevel    2789.021        81.123        0.661    34.380    0.000    2629.798    2948.244 
##          JobRoleHuman Resources    -377.636       249.687       -0.014    -1.512    0.131    -867.708     112.435 
##    JobRoleLaboratory Technician    -619.843       167.755       -0.051    -3.695    0.000    -949.102    -290.583 
##                  JobRoleManager    4018.929       227.798        0.205    17.643    0.000    3571.820    4466.037 
##   JobRoleManufacturing Director     127.393       165.908        0.008     0.768    0.443    -198.242     453.029 
##        JobRoleResearch Director    4009.398       213.059        0.205    18.818    0.000    3591.218    4427.578 
##       JobRoleResearch Scientist    -346.550       167.934       -0.030    -2.064    0.039    -676.163     -16.938 
##          JobRoleSales Executive     -72.176       142.858       -0.007    -0.505    0.614    -352.570     208.217 
##     JobRoleSales Representative    -404.178       210.690       -0.021    -1.918    0.055    -817.710       9.354 
##               TotalWorkingYears      48.287         7.884        0.079     6.125    0.000      32.813      63.762 
## BusinessTravelTravel_Frequently     219.052       138.755        0.018     1.579    0.115     -53.289     491.392 
##     BusinessTravelTravel_Rarely     396.178       117.135        0.039     3.382    0.001     166.273     626.083 
##                      GenderMale     130.188        73.258        0.014     1.777    0.076     -13.599     273.975 
##                       DailyRate       0.154         0.089        0.013     1.721    0.086      -0.022       0.330 
##                     MonthlyRate      -0.009         0.005       -0.013    -1.687    0.092      -0.018       0.001 
## ------------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison
## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre><code>## 
## No more variables to be added/removed.
## 
## 
## Final Model Output 
## ------------------
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                       0.974       RMSE                  1052.279 
## R-Squared               0.949       Coef. Var               16.467 
## Adj. R-Squared          0.948       MSE                1107291.625 
## Pred R-Squared          0.947       MAE                    796.933 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                       ANOVA                                       
## ---------------------------------------------------------------------------------
##                        Sum of                                                    
##                       Squares         DF       Mean Square       F          Sig. 
## ---------------------------------------------------------------------------------
## Regression         1.7424e+10         15    1161599822.648    1049.046    0.0000 
## Residual        945627047.481        854       1107291.625                       
## Total         18369624387.195        869                                         
## ---------------------------------------------------------------------------------
## 
##                                                Parameter Estimates                                                 
## ------------------------------------------------------------------------------------------------------------------
##                           model        Beta    Std. Error    Std. Beta      t        Sig        lower       upper 
## ------------------------------------------------------------------------------------------------------------------
##                     (Intercept)    -485.205       250.241                 -1.939    0.053    -976.364       5.954 
##                        JobLevel    2789.021        81.123        0.661    34.380    0.000    2629.798    2948.244 
##          JobRoleHuman Resources    -377.636       249.687       -0.014    -1.512    0.131    -867.708     112.435 
##    JobRoleLaboratory Technician    -619.843       167.755       -0.051    -3.695    0.000    -949.102    -290.583 
##                  JobRoleManager    4018.929       227.798        0.205    17.643    0.000    3571.820    4466.037 
##   JobRoleManufacturing Director     127.393       165.908        0.008     0.768    0.443    -198.242     453.029 
##        JobRoleResearch Director    4009.398       213.059        0.205    18.818    0.000    3591.218    4427.578 
##       JobRoleResearch Scientist    -346.550       167.934       -0.030    -2.064    0.039    -676.163     -16.938 
##          JobRoleSales Executive     -72.176       142.858       -0.007    -0.505    0.614    -352.570     208.217 
##     JobRoleSales Representative    -404.178       210.690       -0.021    -1.918    0.055    -817.710       9.354 
##               TotalWorkingYears      48.287         7.884        0.079     6.125    0.000      32.813      63.762 
## BusinessTravelTravel_Frequently     219.052       138.755        0.018     1.579    0.115     -53.289     491.392 
##     BusinessTravelTravel_Rarely     396.178       117.135        0.039     3.382    0.001     166.273     626.083 
##                      GenderMale     130.188        73.258        0.014     1.777    0.076     -13.599     273.975 
##                       DailyRate       0.154         0.089        0.013     1.721    0.086      -0.022       0.330 
##                     MonthlyRate      -0.009         0.005       -0.013    -1.687    0.092      -0.018       0.001 
## ------------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## 
##                                      Stepwise Selection Summary                                      
## ----------------------------------------------------------------------------------------------------
##                               Added/                   Adj.                                             
## Step        Variable         Removed     R-Square    R-Square      C(p)         AIC          RMSE       
## ----------------------------------------------------------------------------------------------------
##    1        JobLevel         addition       0.906       0.906    690.6590    15094.3534    1413.2958    
##    2         JobRole         addition       0.945       0.944     44.0580    14641.4330    1084.4355    
##    3    TotalWorkingYears    addition       0.947       0.947      9.1010    14607.2848    1062.7570    
##    4     BusinessTravel      addition       0.948       0.947     -1.7610    14598.3432    1056.1120    
##    5         Gender          addition       0.948       0.947     -3.0160    14597.0365    1054.7224    
##    6        DailyRate        addition       0.948       0.948     -4.1310    14595.8611    1053.4149    
##    7       MonthlyRate       addition       0.949       0.948     -4.9610    14594.9661    1052.2793    
## ----------------------------------------------------------------------------------------------------</code></pre>
<pre class="r"><code>fit2 = lm(MonthlyIncome ~ JobLevel+TotalWorkingYears+BusinessTravel+Gender+DailyRate+MonthlyRate, data=trainingSet)
tab_model(fit2, show.se = T, show.stat = T, string.stat = &quot;t-value&quot;, string.p = &quot;p-value&quot;, string.se = &quot;Std. Error&quot;, pred.labels = c(&quot;Intercept&quot;, &quot;Sq. Ft. of Living Area&quot;))</code></pre>
<pre><code>## Length of `pred.labels` does not equal number of predictors, no labelling applied.</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="5" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
MonthlyIncome
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Std. Error
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t-value
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p-value
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2067.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
225.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2511.45 – -1624.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-9.15
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
JobLevel
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3714.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
69.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3578.62 – 3849.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
53.83
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
TotalWorkingYears
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
55.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
10.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
36.29 – 75.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
5.59
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
BusinessTravelTravel_Frequently
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
30.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
180.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-324.63 – 384.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.868
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
BusinessTravelTravel_Rarely
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
372.49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
153.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
71.48 – 673.50
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.43
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.015</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
GenderMale
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
109.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
95.86
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-78.69 – 297.61
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.254
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
DailyRate
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.24 – 0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.939
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
MonthlyRate
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.02 – 0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.521
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="5">
870
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> / R<sup>2</sup> adjusted
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="5">
0.910 / 0.910
</td>
</tr>
</table>
<pre class="r"><code>summary(fit2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ JobLevel + TotalWorkingYears + BusinessTravel + 
##     Gender + DailyRate + MonthlyRate, data = trainingSet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5373.8  -872.1    39.0   759.6  3898.2 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     -2.068e+03  2.260e+02  -9.151  &lt; 2e-16 ***
## JobLevel                         3.714e+03  6.900e+01  53.829  &lt; 2e-16 ***
## TotalWorkingYears                5.593e+01  1.001e+01   5.589 3.06e-08 ***
## BusinessTravelTravel_Frequently  3.007e+01  1.807e+02   0.166   0.8679    
## BusinessTravelTravel_Rarely      3.725e+02  1.534e+02   2.429   0.0154 *  
## GenderMale                       1.095e+02  9.586e+01   1.142   0.2538    
## DailyRate                       -8.892e-03  1.171e-01  -0.076   0.9395    
## MonthlyRate                     -4.253e-03  6.627e-03  -0.642   0.5212    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1383 on 862 degrees of freedom
## Multiple R-squared:  0.9103, Adjusted R-squared:  0.9095 
## F-statistic:  1249 on 7 and 862 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># Repeat for true test set
predictedSalaries = predict(fit2, newdata = testSalarySet)
submission = tibble(&quot;ID&quot;= testSalarySet$ID, &quot;MonthlyIncome&quot; = predictedSalaries)
write.csv(submission,&quot;Case2PredictionsTbonar Salary.csv&quot;,row.names = FALSE)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
